2025-03-08 20:40:33,285 - train_redd_lf_refrigerator - INFO - Logger setup complete, dataset: redd_lf, appliance: refrigerator
2025-03-08 20:40:33,285 - train_redd_lf_refrigerator - INFO - Log file path: /root/autodl-tmp/ELECTRIcity/logs/redd_lf/refrigerator/train_20250308_204033.log
2025-03-08 20:40:33,285 - train_redd_lf_refrigerator - INFO - Starting training for redd_lf dataset, appliance: refrigerator
2025-03-08 20:40:33,285 - train_redd_lf_refrigerator - INFO - Parameters: batch_size=64, epochs=10, pretrain=True
2025-03-08 20:40:33,285 - train_redd_lf_refrigerator - INFO - Processing redd_lf dataset...
2025-03-08 20:40:33,594 - train_redd_lf_refrigerator - INFO - Creating model...
2025-03-08 20:40:33,650 - train_redd_lf_refrigerator - INFO - Model structure created, hidden size: 64, layers: 2
2025-03-08 20:40:33,650 - train_redd_lf_refrigerator - INFO - Setting up trainer...
2025-03-08 20:40:38,728 - train_redd_lf_refrigerator - INFO - Initializing trainer, export path: results/redd_lf/refrigerator
2025-03-08 20:40:38,728 - train_redd_lf_refrigerator - INFO - Device: cuda:0, pretrain: True
2025-03-08 20:40:38,728 - train_redd_lf_refrigerator - INFO - Pretrain epochs: 10, main epochs: 10
2025-03-08 20:40:38,729 - train_redd_lf_refrigerator - INFO - Cutoff: 400, threshold: 50
2025-03-08 20:40:38,729 - train_redd_lf_refrigerator - INFO - Min on time: 10, min off time: 2
2025-03-08 20:40:38,729 - train_redd_lf_refrigerator - INFO - Pretrain dataloaders created, train batches: 112
2025-03-08 20:40:38,834 - train_redd_lf_refrigerator - INFO - Main dataloaders created, train batches: 112, val batches: 4
2025-03-08 20:40:38,835 - train_redd_lf_refrigerator - INFO - Using optimizer: adam, learning rate: 0.0001
2025-03-08 20:40:38,836 - train_redd_lf_refrigerator - INFO - Using mean normalization, mean: 397.7507357514335, std: 659.7336684415047
2025-03-08 20:40:38,836 - train_redd_lf_refrigerator - INFO - Export directory created: results/redd_lf/refrigerator
2025-03-08 20:40:38,836 - train_redd_lf_refrigerator - INFO - Starting training...
2025-03-08 20:40:38,857 - train_redd_lf_refrigerator - INFO - Successfully loaded previous model, continuing training...
2025-03-08 20:40:40,690 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9981, ACC: 0.2490, F1: 0.3588, MAE: 89.6615
2025-03-08 20:40:40,690 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 92.0673, EACC: 0.0015, NDE: 1109.0921
2025-03-08 20:40:40,690 - train_redd_lf_refrigerator - INFO - Saving best model...
2025-03-08 20:40:40,736 - train_redd_lf_refrigerator - INFO - Model saved to: results/redd_lf/refrigerator/best_acc_model.pth
2025-03-08 20:40:40,736 - train_redd_lf_refrigerator - INFO - Initial validation metrics - MRE: 0.9981, Accuracy: 0.2490, F1: 0.3588
2025-03-08 20:40:40,736 - train_redd_lf_refrigerator - INFO - Starting pretraining phase...
2025-03-08 20:41:08,449 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 1/10, average loss: 0.1580
2025-03-08 20:41:36,318 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 2/10, average loss: 0.1540
2025-03-08 20:42:04,129 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 3/10, average loss: 0.1532
2025-03-08 20:42:31,908 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 4/10, average loss: 0.1527
2025-03-08 20:42:59,736 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 5/10, average loss: 0.1522
2025-03-08 20:43:27,592 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 6/10, average loss: 0.1521
2025-03-08 20:43:55,352 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 7/10, average loss: 0.1512
2025-03-08 20:44:23,254 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 8/10, average loss: 0.1522
2025-03-08 20:44:51,089 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 9/10, average loss: 0.1505
2025-03-08 20:45:18,923 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 10/10, average loss: 0.1497
2025-03-08 20:45:18,923 - train_redd_lf_refrigerator - INFO - Pretraining completed
2025-03-08 20:45:18,924 - train_redd_lf_refrigerator - INFO - Starting main training phase...
2025-03-08 20:45:44,223 - train_redd_lf_refrigerator - INFO - Training Epoch 1/10, average loss: 2.5670
2025-03-08 20:45:45,249 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9988, ACC: 0.8951, F1: 0.7555, MAE: 43.4937
2025-03-08 20:45:45,249 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 69.4485, EACC: 0.0030, NDE: 466.5490
2025-03-08 20:45:45,249 - train_redd_lf_refrigerator - INFO - Epoch 1/10 - MRE: 0.9988, Accuracy: 0.8951, F1: 0.7555
2025-03-08 20:45:45,249 - train_redd_lf_refrigerator - INFO - Found better model - Previous metrics: (MRE=0.9981, ACC=0.2490, F1=0.3588)
2025-03-08 20:45:45,249 - train_redd_lf_refrigerator - INFO - New metrics: (MRE=0.9988, ACC=0.8951, F1=0.7555)
2025-03-08 20:45:45,250 - train_redd_lf_refrigerator - INFO - Saving best model...
2025-03-08 20:45:45,286 - train_redd_lf_refrigerator - INFO - Model saved to: results/redd_lf/refrigerator/best_acc_model.pth
2025-03-08 20:46:10,477 - train_redd_lf_refrigerator - INFO - Training Epoch 2/10, average loss: 2.4270
2025-03-08 20:46:11,548 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9985, ACC: 0.8906, F1: 0.7535, MAE: 41.7565
2025-03-08 20:46:11,548 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 66.7922, EACC: 0.0031, NDE: 455.0179
2025-03-08 20:46:11,548 - train_redd_lf_refrigerator - INFO - Epoch 2/10 - MRE: 0.9985, Accuracy: 0.8906, F1: 0.7535
2025-03-08 20:46:36,790 - train_redd_lf_refrigerator - INFO - Training Epoch 3/10, average loss: 2.3860
2025-03-08 20:46:37,874 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9987, ACC: 0.8910, F1: 0.7528, MAE: 45.3943
2025-03-08 20:46:37,875 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 72.2268, EACC: 0.0029, NDE: 477.6069
2025-03-08 20:46:37,875 - train_redd_lf_refrigerator - INFO - Epoch 3/10 - MRE: 0.9987, Accuracy: 0.8910, F1: 0.7528
2025-03-08 20:47:03,085 - train_redd_lf_refrigerator - INFO - Training Epoch 4/10, average loss: 2.3893
2025-03-08 20:47:04,144 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9987, ACC: 0.8999, F1: 0.7592, MAE: 44.0839
2025-03-08 20:47:04,144 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 71.2420, EACC: 0.0029, NDE: 461.0112
2025-03-08 20:47:04,144 - train_redd_lf_refrigerator - INFO - Epoch 4/10 - MRE: 0.9987, Accuracy: 0.8999, F1: 0.7592
2025-03-08 20:47:04,144 - train_redd_lf_refrigerator - INFO - Found better model - Previous metrics: (MRE=0.9988, ACC=0.8951, F1=0.7555)
2025-03-08 20:47:04,144 - train_redd_lf_refrigerator - INFO - New metrics: (MRE=0.9987, ACC=0.8999, F1=0.7592)
2025-03-08 20:47:04,144 - train_redd_lf_refrigerator - INFO - Saving best model...
2025-03-08 20:47:04,177 - train_redd_lf_refrigerator - INFO - Model saved to: results/redd_lf/refrigerator/best_acc_model.pth
2025-03-08 20:47:29,456 - train_redd_lf_refrigerator - INFO - Training Epoch 5/10, average loss: 2.3756
2025-03-08 20:47:30,538 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9987, ACC: 0.9056, F1: 0.7625, MAE: 41.8019
2025-03-08 20:47:30,538 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 67.7369, EACC: 0.0032, NDE: 438.6344
2025-03-08 20:47:30,538 - train_redd_lf_refrigerator - INFO - Epoch 5/10 - MRE: 0.9987, Accuracy: 0.9056, F1: 0.7625
2025-03-08 20:47:30,538 - train_redd_lf_refrigerator - INFO - Found better model - Previous metrics: (MRE=0.9987, ACC=0.8999, F1=0.7592)
2025-03-08 20:47:30,538 - train_redd_lf_refrigerator - INFO - New metrics: (MRE=0.9987, ACC=0.9056, F1=0.7625)
2025-03-08 20:47:30,538 - train_redd_lf_refrigerator - INFO - Saving best model...
2025-03-08 20:47:30,576 - train_redd_lf_refrigerator - INFO - Model saved to: results/redd_lf/refrigerator/best_acc_model.pth
2025-03-08 20:47:55,874 - train_redd_lf_refrigerator - INFO - Training Epoch 6/10, average loss: 2.3848
2025-03-08 20:47:56,960 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9984, ACC: 0.9024, F1: 0.7610, MAE: 42.3992
2025-03-08 20:47:56,960 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 68.8104, EACC: 0.0031, NDE: 446.7555
2025-03-08 20:47:56,960 - train_redd_lf_refrigerator - INFO - Epoch 6/10 - MRE: 0.9984, Accuracy: 0.9024, F1: 0.7610
2025-03-08 20:48:22,199 - train_redd_lf_refrigerator - INFO - Training Epoch 7/10, average loss: 2.3745
2025-03-08 20:48:23,337 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9990, ACC: 0.8922, F1: 0.7535, MAE: 45.5146
2025-03-08 20:48:23,337 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 72.6020, EACC: 0.0029, NDE: 488.5836
2025-03-08 20:48:23,337 - train_redd_lf_refrigerator - INFO - Epoch 7/10 - MRE: 0.9990, Accuracy: 0.8922, F1: 0.7535
2025-03-08 20:48:48,614 - train_redd_lf_refrigerator - INFO - Training Epoch 8/10, average loss: 2.3699
2025-03-08 20:48:49,673 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9987, ACC: 0.8961, F1: 0.7571, MAE: 43.1491
2025-03-08 20:48:49,673 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 69.7467, EACC: 0.0030, NDE: 466.2419
2025-03-08 20:48:49,673 - train_redd_lf_refrigerator - INFO - Epoch 8/10 - MRE: 0.9987, Accuracy: 0.8961, F1: 0.7571
2025-03-08 20:49:14,933 - train_redd_lf_refrigerator - INFO - Training Epoch 9/10, average loss: 2.3742
2025-03-08 20:49:15,952 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9987, ACC: 0.9014, F1: 0.7603, MAE: 43.6537
2025-03-08 20:49:15,952 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 70.8276, EACC: 0.0030, NDE: 458.0136
2025-03-08 20:49:15,952 - train_redd_lf_refrigerator - INFO - Epoch 9/10 - MRE: 0.9987, Accuracy: 0.9014, F1: 0.7603
2025-03-08 20:49:41,141 - train_redd_lf_refrigerator - INFO - Training Epoch 10/10, average loss: 2.3606
2025-03-08 20:49:42,225 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9987, ACC: 0.8922, F1: 0.7546, MAE: 41.9609
2025-03-08 20:49:42,225 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 67.3819, EACC: 0.0031, NDE: 454.9704
2025-03-08 20:49:42,225 - train_redd_lf_refrigerator - INFO - Epoch 10/10 - MRE: 0.9987, Accuracy: 0.8922, F1: 0.7546
2025-03-08 20:49:42,225 - train_redd_lf_refrigerator - INFO - Training completed, best model at epoch 5
2025-03-08 20:49:42,226 - train_redd_lf_refrigerator - INFO - Best model metrics - MRE: 0.9987, Accuracy: 0.9056, F1: 0.7625
2025-03-08 20:49:42,226 - train_redd_lf_refrigerator - INFO - Generating training visualizations...
2025-03-08 20:49:44,818 - train_redd_lf_refrigerator - INFO - Training visualizations completed for redd_lf - refrigerator
2025-03-08 20:49:44,818 - train_redd_lf_refrigerator - INFO - Total training time: 9.10 minutes
2025-03-08 20:49:44,818 - train_redd_lf_refrigerator - INFO - Starting testing...
2025-03-08 20:49:44,818 - train_redd_lf_refrigerator - INFO - Test houses: [1]
2025-03-08 20:49:45,151 - train_redd_lf_refrigerator - INFO - Successfully loaded best model: results/redd_lf/refrigerator/best_acc_model.pth
2025-03-08 20:49:45,152 - train_redd_lf_refrigerator - INFO - Starting testing...
2025-03-08 20:49:52,696 - train_redd_lf_refrigerator - INFO - Results saved to results/redd_lf/refrigerator/test_result.json
2025-03-08 20:49:52,901 - train_redd_lf_refrigerator - INFO - Test results - MRE: 25.3820, ACC: 0.8969, F1: 0.8778, MAE: 0.4586
2025-03-08 20:49:52,901 - train_redd_lf_refrigerator - INFO - Precision: 0.9699, Recall: 0.8017
2025-03-08 20:49:52,901 - train_redd_lf_refrigerator - INFO - RMSE: 49.7669, EACC: 0.9024, NDE: 0.4804
2025-03-08 20:49:52,902 - train_redd_lf_refrigerator - INFO - Generating prediction visualizations...
2025-03-08 20:49:56,137 - train_redd_lf_refrigerator - INFO - Prediction visualizations completed for redd_lf - refrigerator
2025-03-08 20:49:56,138 - train_redd_lf_refrigerator - INFO - Mean Accuracy: [0.89689342]
2025-03-08 20:49:56,138 - train_redd_lf_refrigerator - INFO - Mean F1-Score: [0.87782553]
2025-03-08 20:49:56,138 - train_redd_lf_refrigerator - INFO - MAE: [0.45862152]
2025-03-08 20:49:56,138 - train_redd_lf_refrigerator - INFO - MRE: [25.38204215]
2025-03-08 20:49:56,165 - train_redd_lf_refrigerator - INFO - Results saved to results/redd_lf/refrigerator/results.pkl
2025-03-08 20:49:56,165 - train_redd_lf_refrigerator - INFO - Training and testing completed
