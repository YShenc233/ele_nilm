2025-03-08 20:24:00,882 - train_redd_lf_refrigerator - INFO - Logger setup complete, dataset: redd_lf, appliance: refrigerator
2025-03-08 20:24:00,882 - train_redd_lf_refrigerator - INFO - Log file path: /root/autodl-tmp/ELECTRIcity/logs/redd_lf/refrigerator/train_20250308_202400.log
2025-03-08 20:24:00,882 - train_redd_lf_refrigerator - INFO - Starting training for redd_lf dataset, appliance: refrigerator
2025-03-08 20:24:00,882 - train_redd_lf_refrigerator - INFO - Parameters: batch_size=64, epochs=10, pretrain=True
2025-03-08 20:24:00,883 - train_redd_lf_refrigerator - INFO - Processing redd_lf dataset...
2025-03-08 20:24:01,252 - train_redd_lf_refrigerator - INFO - Creating model...
2025-03-08 20:24:01,308 - train_redd_lf_refrigerator - INFO - Model structure created, hidden size: 64, layers: 2
2025-03-08 20:24:01,308 - train_redd_lf_refrigerator - INFO - Setting up trainer...
2025-03-08 20:24:06,354 - train_redd_lf_refrigerator - INFO - Initializing trainer, export path: results/redd_lf/refrigerator
2025-03-08 20:24:06,354 - train_redd_lf_refrigerator - INFO - Device: cuda:0, pretrain: True
2025-03-08 20:24:06,355 - train_redd_lf_refrigerator - INFO - Pretrain epochs: 10, main epochs: 10
2025-03-08 20:24:06,355 - train_redd_lf_refrigerator - INFO - Cutoff: 400, threshold: 50
2025-03-08 20:24:06,355 - train_redd_lf_refrigerator - INFO - Min on time: 10, min off time: 2
2025-03-08 20:24:06,356 - train_redd_lf_refrigerator - INFO - Pretrain dataloaders created, train batches: 112
2025-03-08 20:24:06,467 - train_redd_lf_refrigerator - INFO - Main dataloaders created, train batches: 112, val batches: 4
2025-03-08 20:24:06,468 - train_redd_lf_refrigerator - INFO - Using optimizer: adam, learning rate: 0.0001
2025-03-08 20:24:06,468 - train_redd_lf_refrigerator - INFO - Using mean normalization, mean: 397.7507357514335, std: 659.7336684415047
2025-03-08 20:24:06,469 - train_redd_lf_refrigerator - INFO - Export directory created: results/redd_lf/refrigerator
2025-03-08 20:24:06,469 - train_redd_lf_refrigerator - INFO - Starting training...
2025-03-08 20:24:06,489 - train_redd_lf_refrigerator - INFO - Successfully loaded previous model, continuing training...
2025-03-08 20:24:08,007 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9975, ACC: 0.2529, F1: 0.3563, MAE: 70.8280
2025-03-08 20:24:08,007 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 72.3420, EACC: 0.0019, NDE: 875.4732
2025-03-08 20:24:08,007 - train_redd_lf_refrigerator - INFO - Saving best model...
2025-03-08 20:24:08,047 - train_redd_lf_refrigerator - INFO - Model saved to: results/redd_lf/refrigerator/best_acc_model.pth
2025-03-08 20:24:08,047 - train_redd_lf_refrigerator - INFO - Initial validation metrics - MRE: 0.9975, Accuracy: 0.2529, F1: 0.3563
2025-03-08 20:24:08,047 - train_redd_lf_refrigerator - INFO - Starting pretraining phase...
2025-03-08 20:24:35,493 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 1/10, average loss: 0.1712
2025-03-08 20:25:03,002 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 2/10, average loss: 0.1631
2025-03-08 20:25:30,496 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 3/10, average loss: 0.1607
2025-03-08 20:25:58,035 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 4/10, average loss: 0.1590
2025-03-08 20:26:25,553 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 5/10, average loss: 0.1576
2025-03-08 20:26:53,114 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 6/10, average loss: 0.1570
2025-03-08 20:27:20,631 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 7/10, average loss: 0.1558
2025-03-08 20:27:48,162 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 8/10, average loss: 0.1565
2025-03-08 20:28:15,701 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 9/10, average loss: 0.1545
2025-03-08 20:28:43,232 - train_redd_lf_refrigerator - INFO - Pretrain Epoch 10/10, average loss: 0.1533
2025-03-08 20:28:43,232 - train_redd_lf_refrigerator - INFO - Pretraining completed
2025-03-08 20:28:43,232 - train_redd_lf_refrigerator - INFO - Starting main training phase...
2025-03-08 20:29:08,301 - train_redd_lf_refrigerator - INFO - Training Epoch 1/10, average loss: 2.6558
2025-03-08 20:29:09,086 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9986, ACC: 0.8820, F1: 0.7460, MAE: 46.2541
2025-03-08 20:29:09,086 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 73.0273, EACC: 0.0028, NDE: 499.3790
2025-03-08 20:29:09,086 - train_redd_lf_refrigerator - INFO - Epoch 1/10 - MRE: 0.9986, Accuracy: 0.8820, F1: 0.7460
2025-03-08 20:29:09,086 - train_redd_lf_refrigerator - INFO - Found better model - Previous metrics: (MRE=0.9975, ACC=0.2529, F1=0.3563)
2025-03-08 20:29:09,086 - train_redd_lf_refrigerator - INFO - New metrics: (MRE=0.9986, ACC=0.8820, F1=0.7460)
2025-03-08 20:29:09,086 - train_redd_lf_refrigerator - INFO - Saving best model...
2025-03-08 20:29:09,122 - train_redd_lf_refrigerator - INFO - Model saved to: results/redd_lf/refrigerator/best_acc_model.pth
2025-03-08 20:29:34,196 - train_redd_lf_refrigerator - INFO - Training Epoch 2/10, average loss: 2.4769
2025-03-08 20:29:34,975 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9985, ACC: 0.8923, F1: 0.7544, MAE: 40.4295
2025-03-08 20:29:34,975 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 65.0982, EACC: 0.0032, NDE: 438.3891
2025-03-08 20:29:34,975 - train_redd_lf_refrigerator - INFO - Epoch 2/10 - MRE: 0.9985, Accuracy: 0.8923, F1: 0.7544
2025-03-08 20:29:34,975 - train_redd_lf_refrigerator - INFO - Found better model - Previous metrics: (MRE=0.9986, ACC=0.8820, F1=0.7460)
2025-03-08 20:29:34,975 - train_redd_lf_refrigerator - INFO - New metrics: (MRE=0.9985, ACC=0.8923, F1=0.7544)
2025-03-08 20:29:34,975 - train_redd_lf_refrigerator - INFO - Saving best model...
2025-03-08 20:29:35,009 - train_redd_lf_refrigerator - INFO - Model saved to: results/redd_lf/refrigerator/best_acc_model.pth
2025-03-08 20:30:00,049 - train_redd_lf_refrigerator - INFO - Training Epoch 3/10, average loss: 2.4206
2025-03-08 20:30:00,892 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9990, ACC: 0.8790, F1: 0.7452, MAE: 48.0335
2025-03-08 20:30:00,892 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 75.6799, EACC: 0.0027, NDE: 518.3906
2025-03-08 20:30:00,893 - train_redd_lf_refrigerator - INFO - Epoch 3/10 - MRE: 0.9990, Accuracy: 0.8790, F1: 0.7452
2025-03-08 20:30:25,922 - train_redd_lf_refrigerator - INFO - Training Epoch 4/10, average loss: 2.4303
2025-03-08 20:30:26,723 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9990, ACC: 0.8896, F1: 0.7519, MAE: 46.1135
2025-03-08 20:30:26,723 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 73.6198, EACC: 0.0028, NDE: 496.8831
2025-03-08 20:30:26,723 - train_redd_lf_refrigerator - INFO - Epoch 4/10 - MRE: 0.9990, Accuracy: 0.8896, F1: 0.7519
2025-03-08 20:30:51,769 - train_redd_lf_refrigerator - INFO - Training Epoch 5/10, average loss: 2.4067
2025-03-08 20:30:52,566 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9989, ACC: 0.8988, F1: 0.7593, MAE: 42.1424
2025-03-08 20:30:52,566 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 67.9848, EACC: 0.0031, NDE: 451.0570
2025-03-08 20:30:52,566 - train_redd_lf_refrigerator - INFO - Epoch 5/10 - MRE: 0.9989, Accuracy: 0.8988, F1: 0.7593
2025-03-08 20:30:52,566 - train_redd_lf_refrigerator - INFO - Found better model - Previous metrics: (MRE=0.9985, ACC=0.8923, F1=0.7544)
2025-03-08 20:30:52,566 - train_redd_lf_refrigerator - INFO - New metrics: (MRE=0.9989, ACC=0.8988, F1=0.7593)
2025-03-08 20:30:52,566 - train_redd_lf_refrigerator - INFO - Saving best model...
2025-03-08 20:30:52,602 - train_redd_lf_refrigerator - INFO - Model saved to: results/redd_lf/refrigerator/best_acc_model.pth
2025-03-08 20:31:17,715 - train_redd_lf_refrigerator - INFO - Training Epoch 6/10, average loss: 2.3871
2025-03-08 20:31:18,589 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9987, ACC: 0.8973, F1: 0.7569, MAE: 41.0482
2025-03-08 20:31:18,589 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 66.6756, EACC: 0.0032, NDE: 445.0452
2025-03-08 20:31:18,590 - train_redd_lf_refrigerator - INFO - Epoch 6/10 - MRE: 0.9987, Accuracy: 0.8973, F1: 0.7569
2025-03-08 20:31:43,603 - train_redd_lf_refrigerator - INFO - Training Epoch 7/10, average loss: 2.3870
2025-03-08 20:31:44,480 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9991, ACC: 0.8852, F1: 0.7498, MAE: 46.9336
2025-03-08 20:31:44,480 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 74.4340, EACC: 0.0028, NDE: 510.6129
2025-03-08 20:31:44,480 - train_redd_lf_refrigerator - INFO - Epoch 7/10 - MRE: 0.9991, Accuracy: 0.8852, F1: 0.7498
2025-03-08 20:32:09,497 - train_redd_lf_refrigerator - INFO - Training Epoch 8/10, average loss: 2.3787
2025-03-08 20:32:10,307 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9988, ACC: 0.8878, F1: 0.7513, MAE: 44.8537
2025-03-08 20:32:10,307 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 71.9265, EACC: 0.0029, NDE: 485.8489
2025-03-08 20:32:10,307 - train_redd_lf_refrigerator - INFO - Epoch 8/10 - MRE: 0.9988, Accuracy: 0.8878, F1: 0.7513
2025-03-08 20:32:35,308 - train_redd_lf_refrigerator - INFO - Training Epoch 9/10, average loss: 2.3907
2025-03-08 20:32:36,176 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9989, ACC: 0.8983, F1: 0.7579, MAE: 43.4826
2025-03-08 20:32:36,176 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 70.3653, EACC: 0.0030, NDE: 463.8071
2025-03-08 20:32:36,176 - train_redd_lf_refrigerator - INFO - Epoch 9/10 - MRE: 0.9989, Accuracy: 0.8983, F1: 0.7579
2025-03-08 20:33:01,194 - train_redd_lf_refrigerator - INFO - Training Epoch 10/10, average loss: 2.3804
2025-03-08 20:33:01,994 - train_redd_lf_refrigerator - INFO - Validation results - MRE: 0.9990, ACC: 0.8830, F1: 0.7484, MAE: 44.1117
2025-03-08 20:33:01,994 - train_redd_lf_refrigerator - INFO - Additional metrics - RMSE: 69.8259, EACC: 0.0030, NDE: 482.0815
2025-03-08 20:33:01,994 - train_redd_lf_refrigerator - INFO - Epoch 10/10 - MRE: 0.9990, Accuracy: 0.8830, F1: 0.7484
2025-03-08 20:33:01,994 - train_redd_lf_refrigerator - INFO - Training completed, best model at epoch 5
2025-03-08 20:33:01,994 - train_redd_lf_refrigerator - INFO - Best model metrics - MRE: 0.9989, Accuracy: 0.8988, F1: 0.7593
2025-03-08 20:33:01,994 - train_redd_lf_refrigerator - INFO - Generating training visualizations...
2025-03-08 20:33:04,463 - train_redd_lf_refrigerator - INFO - Training visualizations completed for redd_lf - refrigerator
2025-03-08 20:33:04,463 - train_redd_lf_refrigerator - INFO - Total training time: 8.97 minutes
2025-03-08 20:33:04,463 - train_redd_lf_refrigerator - INFO - Starting testing...
2025-03-08 20:33:04,464 - train_redd_lf_refrigerator - INFO - Test houses: [1]
2025-03-08 20:33:04,771 - train_redd_lf_refrigerator - INFO - Successfully loaded best model: results/redd_lf/refrigerator/best_acc_model.pth
2025-03-08 20:33:04,771 - train_redd_lf_refrigerator - INFO - Starting testing...
2025-03-08 20:33:11,770 - train_redd_lf_refrigerator - INFO - Results saved to results/redd_lf/refrigerator/test_result.json
2025-03-08 20:33:11,971 - train_redd_lf_refrigerator - INFO - Test results - MRE: 25.3396, ACC: 0.8966, F1: 0.8775, MAE: 0.4585
2025-03-08 20:33:11,972 - train_redd_lf_refrigerator - INFO - Precision: 0.9703, Recall: 0.8009
2025-03-08 20:33:11,972 - train_redd_lf_refrigerator - INFO - RMSE: 49.7645, EACC: 0.9072, NDE: 0.4804
2025-03-08 20:33:11,972 - train_redd_lf_refrigerator - INFO - Generating prediction visualizations...
2025-03-08 20:33:15,219 - train_redd_lf_refrigerator - INFO - Prediction visualizations completed for redd_lf - refrigerator
